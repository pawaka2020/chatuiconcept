CREATE TABLE chat_messages (
  uid UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  sender_uid UUID REFERENCES chat_users_large(uid),
  recipient_uid UUID REFERENCES chat_users_large(uid),
  message TEXT,
  file_url TEXT,
  date_sent TIMESTAMP
);

CREATE INDEX sender_uid_idx_cm ON chat_messages (sender_uid);
CREATE INDEX recipient_uid_idx_cm ON chat_messages (recipient_uid);
CREATE INDEX date_sent_idx_cm ON chat_messages (date_sent);

CREATE TABLE chat_users_large (
uid uuid PRIMARY KEY DEFAULT uuid_generate_v4(),
name TEXT,
email TEXT,
signature TEXT,
avatar_url TEXT,
date_created TIMESTAMPTZ,
contacts TEXT[] DEFAULT '{}'
);
CREATE INDEX name_idx_cul ON chat_users_large (name);
CREATE INDEX email_idx_cul ON chat_users_large (email);